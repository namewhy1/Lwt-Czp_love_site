<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†åå° - é‡è§ä½ ï¼ŒçœŸå¥½</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #e8a4b8;
            --primary-dark: #d4899e;
            --secondary: #f5d0d8;
            --bg: #faf6f2;
            --card-bg: #ffffff;
            --text: #4a3f44;
            --text-light: #6b5b5f;
            --border: #e8ddd5;
            --success: #7fb77e;
            --danger: #e57373;
            --shadow: rgba(0, 0, 0, 0.08);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }

        /* ä¾§è¾¹æ  */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            height: 100vh;
            background: var(--card-bg);
            border-right: 1px solid var(--border);
            padding: 2rem 0;
            z-index: 100;
        }

        .logo {
            padding: 0 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1rem;
        }

        .logo h1 {
            font-size: 1.2rem;
            color: var(--primary);
            font-weight: 600;
        }

        .logo p {
            font-size: 0.75rem;
            color: var(--text-light);
            margin-top: 0.3rem;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: var(--secondary);
        }

        .nav-item.active {
            background: linear-gradient(90deg, rgba(232, 164, 184, 0.2), transparent);
            border-left-color: var(--primary);
            color: var(--primary-dark);
        }

        .nav-item i {
            font-size: 1.1rem;
            width: 24px;
            text-align: center;
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            margin-left: 250px;
            padding: 2rem;
            min-height: 100vh;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .header h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .preview-btn {
            padding: 0.6rem 1.5rem;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .preview-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(232, 164, 184, 0.4);
        }

        /* å†…å®¹é¢æ¿ */
        .panel {
            display: none;
        }

        .panel.active {
            display: block;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px var(--shadow);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            padding-bottom: 0.8rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card-title i {
            color: var(--primary);
        }

        /* è¡¨å•æ ·å¼ */
        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-group label {
            display: block;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        .form-group input[type="text"],
        .form-group input[type="date"],
        .form-group input[type="url"],
        .form-group textarea {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
            background: var(--bg);
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-hint {
            font-size: 0.75rem;
            color: var(--text-light);
            margin-top: 0.3rem;
        }

        /* å›¾ç‰‡åˆ—è¡¨ */
        .image-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .image-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            aspect-ratio: 4/3;
            background: var(--bg);
            border: 2px dashed var(--border);
        }

        .image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-item .remove-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 28px;
            height: 28px;
            background: rgba(229, 115, 115, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .image-item:hover .remove-btn {
            opacity: 1;
        }

        .image-item .caption-input {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 0.5rem;
            background: rgba(0, 0, 0, 0.6);
        }

        .image-item .caption-input input {
            width: 100%;
            padding: 0.4rem 0.6rem;
            border: none;
            border-radius: 4px;
            font-size: 0.8rem;
            background: rgba(255, 255, 255, 0.9);
        }

        .add-image-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-light);
            transition: all 0.3s ease;
        }

        .add-image-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .add-image-btn i {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        /* æ—¶é—´è½´ç¼–è¾‘ */
        .timeline-item-edit {
            background: var(--bg);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            position: relative;
        }

        .timeline-item-edit .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .timeline-item-edit .item-number {
            font-weight: 600;
            color: var(--primary);
        }

        /* æ‰“å­—æœºæ–‡å­—åˆ—è¡¨ */
        .text-list-item {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.8rem;
        }

        .text-list-item input {
            flex: 1;
        }

        .text-list-item .remove-text-btn {
            padding: 0.5rem 0.8rem;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-family: inherit;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            box-shadow: 0 5px 15px rgba(232, 164, 184, 0.4);
        }

        .btn-secondary {
            background: var(--bg);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--secondary);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 0.8rem;
            margin-top: 1.5rem;
        }

        /* æç¤ºæ¶ˆæ¯ */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 1rem 1.5rem;
            background: var(--success);
            color: white;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                padding: 1rem;
            }

            .nav-menu {
                display: flex;
                overflow-x: auto;
                gap: 0.5rem;
                padding-bottom: 0.5rem;
            }

            .nav-item {
                padding: 0.6rem 1rem;
                white-space: nowrap;
                border-left: none;
                border-radius: 20px;
            }

            .nav-item.active {
                background: var(--primary);
                color: white;
            }

            .main-content {
                margin-left: 0;
                padding: 1rem;
            }

            .image-list {
                grid-template-columns: repeat(2, 1fr);
            }

            .header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
        }

        /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */
        .file-upload-area {
            border: 2px dashed var(--border);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--bg);
        }

        .file-upload-area:hover {
            border-color: var(--primary);
            background: rgba(232, 164, 184, 0.1);
        }

        .file-upload-area i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 0.8rem;
        }

        .file-upload-area p {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .file-upload-area input[type="file"] {
            display: none;
        }

        .current-music {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg);
            border-radius: 8px;
            margin-top: 1rem;
        }

        .current-music i {
            font-size: 2rem;
            color: var(--primary);
        }

        .current-music-info {
            flex: 1;
        }

        .current-music-info .name {
            font-weight: 500;
        }

        .current-music-info .size {
            font-size: 0.8rem;
            color: var(--text-light);
        }
    </style>
</head>
<body>
    <!-- ä¾§è¾¹æ  -->
    <div class="sidebar">
        <div class="logo">
            <h1>ğŸ’• ç½‘ç«™ç®¡ç†åå°</h1>
            <p>é‡è§ä½ ï¼ŒçœŸå¥½</p>
        </div>
        <ul class="nav-menu">
            <li class="nav-item active" data-panel="basic">
                <span>âš™ï¸</span>
                <span>åŸºç¡€è®¾ç½®</span>
            </li>
            <li class="nav-item" data-panel="photos">
                <span>ğŸ–¼ï¸</span>
                <span>ç›¸å†Œç®¡ç†</span>
            </li>
            <li class="nav-item" data-panel="music">
                <span>ğŸµ</span>
                <span>éŸ³ä¹è®¾ç½®</span>
            </li>
            <li class="nav-item" data-panel="timeline">
                <span>ğŸ“–</span>
                <span>æ•…äº‹æ—¶é—´è½´</span>
            </li>
            <li class="nav-item" data-panel="message">
                <span>ğŸ’Œ</span>
                <span>å¿ƒè¯­ç•™è¨€</span>
            </li>
        </ul>
    </div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content">
        <div class="header">
            <h2 id="panelTitle">åŸºç¡€è®¾ç½®</h2>
            <a href="czp.html" target="_blank" class="preview-btn">
                <span>ğŸ‘ï¸</span>
                é¢„è§ˆç½‘ç«™
            </a>
        </div>

        <!-- åŸºç¡€è®¾ç½®é¢æ¿ -->
        <div class="panel active" id="panel-basic">
            <div class="card">
                <h3 class="card-title">
                    <span>ğŸ“…</span>
                    æ‹çˆ±çºªå¿µæ—¥
                </h3>
                <div class="form-group">
                    <label>åœ¨ä¸€èµ·çš„æ—¥æœŸ</label>
                    <input type="date" id="loveDate">
                    <p class="form-hint">è®¾ç½®ä½ ä»¬åœ¨ä¸€èµ·çš„æ—¥æœŸï¼Œé¦–é¡µä¼šè‡ªåŠ¨è®¡ç®—å¤©æ•°</p>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">
                    <span>âœï¸</span>
                    æ‰“å­—æœºæ–‡å­—
                </h3>
                <p class="form-hint" style="margin-bottom: 1rem;">é¦–é¡µä¼šå¾ªç¯æ˜¾ç¤ºè¿™äº›æµªæ¼«å¥å­</p>
                <div id="typewriterTexts"></div>
                <button class="btn btn-secondary" onclick="addTypewriterText()">
                    <span>â•</span>
                    æ·»åŠ å¥å­
                </button>
            </div>

            <div class="card">
                <h3 class="card-title">
                    <span>ğŸ“</span>
                    ç½‘ç«™æ ‡é¢˜
                </h3>
                <div class="form-group">
                    <label>ä¸»æ ‡é¢˜</label>
                    <input type="text" id="siteTitle" placeholder="é‡è§ä½ ï¼ŒçœŸå¥½">
                </div>
                <div class="form-group">
                    <label>å‰¯æ ‡é¢˜</label>
                    <input type="text" id="siteSubtitle" placeholder="çŒ®ç»™æœ€ç‰¹åˆ«çš„ä½ ">
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" onclick="saveBasicSettings()">
                    <span>ğŸ’¾</span>
                    ä¿å­˜è®¾ç½®
                </button>
                <button class="btn btn-secondary" onclick="resetBasicSettings()">
                    <span>ğŸ”„</span>
                    é‡ç½®é»˜è®¤
                </button>
            </div>
        </div>

        <!-- ç›¸å†Œç®¡ç†é¢æ¿ -->
        <div class="panel" id="panel-photos">
            <div class="card">
                <h3 class="card-title">
                    <span>ğŸ–¼ï¸</span>
                    ç…§ç‰‡ç®¡ç†
                </h3>
                <p class="form-hint" style="margin-bottom: 1rem;">æ·»åŠ ä½ ä»¬çš„ç…§ç‰‡ï¼Œæ”¯æŒå›¾ç‰‡URLæˆ–æœ¬åœ°å›¾ç‰‡ï¼ˆè½¬ä¸ºBase64ï¼‰</p>
                
                <div class="image-list" id="photoList"></div>
                
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button class="btn btn-secondary" onclick="addPhotoUrl()">
                        <span>ğŸ”—</span>
                        æ·»åŠ å›¾ç‰‡é“¾æ¥
                    </button>
                    <label class="btn btn-secondary" style="cursor: pointer;">
                        <span>ğŸ“</span>
                        ä¸Šä¼ æœ¬åœ°å›¾ç‰‡
                        <input type="file" accept="image/*" multiple onchange="uploadLocalPhotos(this)" style="display: none;">
                    </label>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" onclick="savePhotoSettings()">
                    <span>ğŸ’¾</span>
                    ä¿å­˜ç›¸å†Œ
                </button>
            </div>
        </div>

        <!-- éŸ³ä¹è®¾ç½®é¢æ¿ -->
        <div class="panel" id="panel-music">
            <div class="card">
                <h3 class="card-title">
                    <span>ğŸµ</span>
                    èƒŒæ™¯éŸ³ä¹
                </h3>
                
                <div class="form-group">
                    <label>æ­Œæ›²åç§°</label>
                    <input type="text" id="musicTitle" placeholder="æ™´å¤©">
                </div>
                
                <div class="form-group">
                    <label>æ­Œæ‰‹</label>
                    <input type="text" id="musicArtist" placeholder="å‘¨æ°ä¼¦">
                </div>
                
                <div class="form-group">
                    <label>éŸ³ä¹æ–‡ä»¶URL</label>
                    <input type="url" id="musicUrl" placeholder="https://example.com/music.mp3">
                    <p class="form-hint">å¡«å†™éŸ³ä¹æ–‡ä»¶çš„ç½‘ç»œåœ°å€ï¼Œæˆ–ä¸Šä¼ æœ¬åœ°æ–‡ä»¶</p>
                </div>

                <div class="file-upload-area" onclick="document.getElementById('musicFile').click()">
                    <div>ğŸµ</div>
                    <p>ç‚¹å‡»ä¸Šä¼ æœ¬åœ°éŸ³ä¹æ–‡ä»¶</p>
                    <p class="form-hint">æ”¯æŒ MP3ã€WAV ç­‰æ ¼å¼</p>
                    <input type="file" id="musicFile" accept="audio/*" onchange="uploadLocalMusic(this)">
                </div>

                <div class="current-music" id="currentMusic" style="display: none;">
                    <span>ğŸµ</span>
                    <div class="current-music-info">
                        <div class="name" id="currentMusicName">-</div>
                        <div class="size" id="currentMusicSize">-</div>
                    </div>
                    <button class="btn btn-danger" onclick="removeMusic()">åˆ é™¤</button>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" onclick="saveMusicSettings()">
                    <span>ğŸ’¾</span>
                    ä¿å­˜è®¾ç½®
                </button>
            </div>
        </div>

        <!-- æ—¶é—´è½´é¢æ¿ -->
        <div class="panel" id="panel-timeline">
            <div class="card">
                <h3 class="card-title">
                    <span>ğŸ“–</span>
                    æ•…äº‹æ—¶é—´è½´
                </h3>
                <p class="form-hint" style="margin-bottom: 1rem;">è®°å½•ä½ ä»¬çš„çˆ±æƒ…æ•…äº‹</p>
                
                <div id="timelineItems"></div>
                
                <button class="btn btn-secondary" onclick="addTimelineItem()">
                    <span>â•</span>
                    æ·»åŠ æ•…äº‹
                </button>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" onclick="saveTimelineSettings()">
                    <span>ğŸ’¾</span>
                    ä¿å­˜æ•…äº‹
                </button>
            </div>
        </div>

        <!-- å¿ƒè¯­ç•™è¨€é¢æ¿ -->
        <div class="panel" id="panel-message">
            <div class="card">
                <h3 class="card-title">
                    <span>ğŸ’Œ</span>
                    å¿ƒè¯­å†…å®¹
                </h3>
                
                <div class="form-group">
                    <label>ç•™è¨€å†…å®¹</label>
                    <textarea id="messageContent" rows="6" placeholder="æ„Ÿè°¢ä½ å‡ºç°åœ¨æˆ‘çš„ç”Ÿå‘½é‡Œ&#10;è®©å¹³å‡¡çš„æ—¥å­é—ªé—ªå‘å…‰&#10;æ„¿æœªæ¥çš„æ¯ä¸€å¤©&#10;éƒ½æœ‰ä½ çš„é™ªä¼´"></textarea>
                    <p class="form-hint">æ¯è¡Œä¸€å¥è¯ï¼Œä¼šè‡ªåŠ¨æ¢è¡Œæ˜¾ç¤º</p>
                </div>
                
                <div class="form-group">
                    <label>ç½²å</label>
                    <input type="text" id="messageSignature" placeholder="å†™ç»™æœ€ç‰¹åˆ«çš„ä½ ">
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" onclick="saveMessageSettings()">
                    <span>ğŸ’¾</span>
                    ä¿å­˜å¿ƒè¯­
                </button>
            </div>
        </div>
    </div>

    <!-- æç¤ºæ¶ˆæ¯ -->
    <div class="toast" id="toast">ä¿å­˜æˆåŠŸï¼</div>

    <script>
        // ============ å¯¼èˆªåˆ‡æ¢ ============
        const navItems = document.querySelectorAll('.nav-item');
        const panels = document.querySelectorAll('.panel');
        const panelTitle = document.getElementById('panelTitle');
        
        const panelTitles = {
            'basic': 'åŸºç¡€è®¾ç½®',
            'photos': 'ç›¸å†Œç®¡ç†',
            'music': 'éŸ³ä¹è®¾ç½®',
            'timeline': 'æ•…äº‹æ—¶é—´è½´',
            'message': 'å¿ƒè¯­ç•™è¨€'
        };

        navItems.forEach(item => {
            item.addEventListener('click', () => {
                const panel = item.dataset.panel;
                
                navItems.forEach(i => i.classList.remove('active'));
                panels.forEach(p => p.classList.remove('active'));
                
                item.classList.add('active');
                document.getElementById(`panel-${panel}`).classList.add('active');
                panelTitle.textContent = panelTitles[panel];
            });
        });

        // ============ æ˜¾ç¤ºæç¤º ============
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.background = type === 'success' ? '#7fb77e' : '#e57373';
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2500);
        }

        // ============ åŸºç¡€è®¾ç½® ============
        let typewriterTexts = [
            'æ—¶å…‰æ¸©æŸ”ï¼Œè®°å½•ä¸‹æˆ‘ä»¬ç›¸é‡çš„æ¯ä¸€ä¸ªç¬é—´',
            'ä½ æ˜¯æˆ‘æœ€ç¾ä¸½çš„æ„å¤–',
            'é‡è§ä½ æ˜¯æˆ‘æœ€å¤§çš„å¹¸è¿',
            'æ„¿ä¸ä½ å…±åº¦ä½™ç”Ÿçš„æ¯ä¸€å¤©'
        ];

        function renderTypewriterTexts() {
            const container = document.getElementById('typewriterTexts');
            container.innerHTML = typewriterTexts.map((text, index) => `
                <div class="text-list-item">
                    <input type="text" value="${text}" onchange="typewriterTexts[${index}] = this.value">
                    <button class="remove-text-btn" onclick="removeTypewriterText(${index})">âœ•</button>
                </div>
            `).join('');
        }

        function addTypewriterText() {
            typewriterTexts.push('æ–°çš„æµªæ¼«å¥å­...');
            renderTypewriterTexts();
        }

        function removeTypewriterText(index) {
            if (typewriterTexts.length > 1) {
                typewriterTexts.splice(index, 1);
                renderTypewriterTexts();
            }
        }

        function saveBasicSettings() {
            const settings = {
                loveDate: document.getElementById('loveDate').value,
                typewriterTexts: typewriterTexts,
                siteTitle: document.getElementById('siteTitle').value,
                siteSubtitle: document.getElementById('siteSubtitle').value
            };
            localStorage.setItem('lovesite_basic', JSON.stringify(settings));
            showToast('åŸºç¡€è®¾ç½®ä¿å­˜æˆåŠŸï¼');
        }

        function loadBasicSettings() {
            const saved = localStorage.getItem('lovesite_basic');
            if (saved) {
                const settings = JSON.parse(saved);
                document.getElementById('loveDate').value = settings.loveDate || '2025-12-24';
                document.getElementById('siteTitle').value = settings.siteTitle || 'é‡è§ä½ ï¼ŒçœŸå¥½';
                document.getElementById('siteSubtitle').value = settings.siteSubtitle || 'çŒ®ç»™æœ€ç‰¹åˆ«çš„ä½ ';
                if (settings.typewriterTexts) {
                    typewriterTexts = settings.typewriterTexts;
                }
            } else {
                document.getElementById('loveDate').value = '2025-12-24';
            }
            renderTypewriterTexts();
        }

        function resetBasicSettings() {
            localStorage.removeItem('lovesite_basic');
            typewriterTexts = [
                'æ—¶å…‰æ¸©æŸ”ï¼Œè®°å½•ä¸‹æˆ‘ä»¬ç›¸é‡çš„æ¯ä¸€ä¸ªç¬é—´',
                'ä½ æ˜¯æˆ‘æœ€ç¾ä¸½çš„æ„å¤–',
                'é‡è§ä½ æ˜¯æˆ‘æœ€å¤§çš„å¹¸è¿',
                'æ„¿ä¸ä½ å…±åº¦ä½™ç”Ÿçš„æ¯ä¸€å¤©'
            ];
            loadBasicSettings();
            showToast('å·²é‡ç½®ä¸ºé»˜è®¤è®¾ç½®');
        }

        // ============ ç›¸å†Œç®¡ç† ============
        let photos = [
            { url: 'https://picsum.photos/1200/800?random=1', caption: 'æ¯ä¸€å¼ ç…§ç‰‡ï¼Œéƒ½æ˜¯ä¸€æ®µç¾å¥½çš„å›å¿†' },
            { url: 'https://picsum.photos/1200/800?random=2', caption: 'ä½ çš„ç¬‘å®¹æ˜¯æˆ‘æœ€çˆ±çš„é£æ™¯' },
            { url: 'https://picsum.photos/1200/800?random=3', caption: 'å’Œä½ åœ¨ä¸€èµ·çš„æ¯ä¸€åˆ»éƒ½å¾ˆçè´µ' },
            { url: 'https://picsum.photos/1200/800?random=4', caption: 'è¿™æ˜¯æˆ‘ä»¬çš„æ•…äº‹' }
        ];

        function renderPhotos() {
            const container = document.getElementById('photoList');
            container.innerHTML = photos.map((photo, index) => `
                <div class="image-item">
                    <img src="${photo.url}" alt="ç…§ç‰‡${index + 1}" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22200%22 height=%22150%22><rect fill=%22%23f5d0d8%22 width=%22200%22 height=%22150%22/><text x=%2250%%22 y=%2250%%22 text-anchor=%22middle%22 fill=%22%23e8a4b8%22>å›¾ç‰‡åŠ è½½å¤±è´¥</text></svg>'">
                    <button class="remove-btn" onclick="removePhoto(${index})">âœ•</button>
                    <div class="caption-input">
                        <input type="text" value="${photo.caption}" placeholder="å›¾ç‰‡è¯´æ˜" onchange="photos[${index}].caption = this.value">
                    </div>
                </div>
            `).join('');
        }

        function addPhotoUrl() {
            const url = prompt('è¯·è¾“å…¥å›¾ç‰‡URLï¼š');
            if (url) {
                photos.push({ url, caption: 'æ–°çš„ç¾å¥½å›å¿†' });
                renderPhotos();
            }
        }

        function uploadLocalPhotos(input) {
            const files = input.files;
            for (let file of files) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    photos.push({
                        url: e.target.result,
                        caption: file.name.replace(/\.[^/.]+$/, '')
                    });
                    renderPhotos();
                };
                reader.readAsDataURL(file);
            }
            input.value = '';
        }

        function removePhoto(index) {
            if (confirm('ç¡®å®šåˆ é™¤è¿™å¼ ç…§ç‰‡å—ï¼Ÿ')) {
                photos.splice(index, 1);
                renderPhotos();
            }
        }

        function savePhotoSettings() {
            localStorage.setItem('lovesite_photos', JSON.stringify(photos));
            showToast('ç›¸å†Œä¿å­˜æˆåŠŸï¼');
        }

        function loadPhotoSettings() {
            const saved = localStorage.getItem('lovesite_photos');
            if (saved) {
                photos = JSON.parse(saved);
            }
            renderPhotos();
        }

        // ============ éŸ³ä¹è®¾ç½® ============
        let musicData = {
            title: 'æ™´å¤©',
            artist: 'å‘¨æ°ä¼¦',
            url: ''
        };

        function saveMusicSettings() {
            musicData.title = document.getElementById('musicTitle').value;
            musicData.artist = document.getElementById('musicArtist').value;
            musicData.url = document.getElementById('musicUrl').value;
            localStorage.setItem('lovesite_music', JSON.stringify(musicData));
            showToast('éŸ³ä¹è®¾ç½®ä¿å­˜æˆåŠŸï¼');
        }

        function loadMusicSettings() {
            const saved = localStorage.getItem('lovesite_music');
            if (saved) {
                musicData = JSON.parse(saved);
            }
            document.getElementById('musicTitle').value = musicData.title || 'æ™´å¤©';
            document.getElementById('musicArtist').value = musicData.artist || 'å‘¨æ°ä¼¦';
            document.getElementById('musicUrl').value = musicData.url || '';
            
            if (musicData.url) {
                showCurrentMusic();
            }
        }

        function uploadLocalMusic(input) {
            const file = input.files[0];
            if (file) {
                // å¯¹äºè¾ƒå¤§çš„éŸ³ä¹æ–‡ä»¶ï¼Œæˆ‘ä»¬å­˜å‚¨URLè€Œä¸æ˜¯base64
                // è¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä¸´æ—¶URLç”¨äºé¢„è§ˆ
                const url = URL.createObjectURL(file);
                document.getElementById('musicUrl').value = url;
                musicData.url = url;
                musicData.fileName = file.name;
                musicData.fileSize = (file.size / 1024 / 1024).toFixed(2) + ' MB';
                
                // åŒæ—¶å­˜å‚¨base64ç”¨äºæŒä¹…åŒ–ï¼ˆæ³¨æ„ï¼šå¤§æ–‡ä»¶å¯èƒ½ä¼šæœ‰é—®é¢˜ï¼‰
                const reader = new FileReader();
                reader.onload = function(e) {
                    musicData.url = e.target.result;
                    document.getElementById('musicUrl').value = 'å·²ä¸Šä¼ : ' + file.name;
                    showCurrentMusic();
                };
                reader.readAsDataURL(file);
            }
        }

        function showCurrentMusic() {
            const container = document.getElementById('currentMusic');
            container.style.display = 'flex';
            document.getElementById('currentMusicName').textContent = musicData.fileName || 'å·²è®¾ç½®éŸ³ä¹';
            document.getElementById('currentMusicSize').textContent = musicData.fileSize || '';
        }

        function removeMusic() {
            musicData.url = '';
            musicData.fileName = '';
            musicData.fileSize = '';
            document.getElementById('musicUrl').value = '';
            document.getElementById('currentMusic').style.display = 'none';
        }

        // ============ æ—¶é—´è½´è®¾ç½® ============
        let timelineItems = [
            { date: '2024å¹´ Â· æ˜¥', title: 'åˆæ¬¡ç›¸é‡', content: 'ç¼˜åˆ†è®©æˆ‘ä»¬åœ¨èŒ«èŒ«äººæµ·ä¸­ç›¸é‡ï¼Œé‚£ä¸€åˆ»ä»¿ä½›æ—¶é—´éƒ½é™æ­¢äº†ï¼Œæˆ‘çŸ¥é“ä½ å°±æ˜¯æˆ‘ä¸€ç›´åœ¨å¯»æ‰¾çš„äººã€‚' },
            { date: '2024å¹´ Â· å¤', title: 'æ¸æ¸ç†Ÿæ‚‰', content: 'ä»é™Œç”Ÿåˆ°ç†Ÿæ‚‰ï¼Œæ¯ä¸€æ¬¡å¯¹è¯éƒ½è®©æˆ‘æ›´äº†è§£ä½ ï¼Œå‘ç°ä½ èº«ä¸Šæ›´å¤šç¾å¥½çš„ç‰¹è´¨ã€‚' },
            { date: 'æ­¤åˆ» Â· ç°åœ¨', title: 'æœªæ¥å¯æœŸ', content: 'æ„Ÿè°¢å‘½è¿çš„å®‰æ’ï¼Œè®©æˆ‘é‡è§äº†ä½ ã€‚æœŸå¾…ä¸ä½ ä¸€èµ·ï¼Œä¹¦å†™æ›´å¤šç¾å¥½çš„ç¯‡ç« ã€‚' }
        ];

        function renderTimelineItems() {
            const container = document.getElementById('timelineItems');
            container.innerHTML = timelineItems.map((item, index) => `
                <div class="timeline-item-edit">
                    <div class="item-header">
                        <span class="item-number">æ•…äº‹ ${index + 1}</span>
                        <button class="btn btn-danger" onclick="removeTimelineItem(${index})" style="padding: 0.3rem 0.6rem; font-size: 0.8rem;">åˆ é™¤</button>
                    </div>
                    <div class="form-group">
                        <label>æ—¥æœŸ</label>
                        <input type="text" value="${item.date}" onchange="timelineItems[${index}].date = this.value" placeholder="2024å¹´ Â· æ˜¥">
                    </div>
                    <div class="form-group">
                        <label>æ ‡é¢˜</label>
                        <input type="text" value="${item.title}" onchange="timelineItems[${index}].title = this.value" placeholder="åˆæ¬¡ç›¸é‡">
                    </div>
                    <div class="form-group">
                        <label>å†…å®¹</label>
                        <textarea onchange="timelineItems[${index}].content = this.value" placeholder="æè¿°è¿™æ®µæ•…äº‹...">${item.content}</textarea>
                    </div>
                </div>
            `).join('');
        }

        function addTimelineItem() {
            timelineItems.push({
                date: 'æ–°çš„æ—¶é—´',
                title: 'æ–°çš„æ•…äº‹',
                content: 'åœ¨è¿™é‡Œå†™ä¸‹ä½ ä»¬çš„æ•…äº‹...'
            });
            renderTimelineItems();
        }

        function removeTimelineItem(index) {
            if (timelineItems.length > 1 && confirm('ç¡®å®šåˆ é™¤è¿™æ®µæ•…äº‹å—ï¼Ÿ')) {
                timelineItems.splice(index, 1);
                renderTimelineItems();
            }
        }

        function saveTimelineSettings() {
            localStorage.setItem('lovesite_timeline', JSON.stringify(timelineItems));
            showToast('æ•…äº‹æ—¶é—´è½´ä¿å­˜æˆåŠŸï¼');
        }

        function loadTimelineSettings() {
            const saved = localStorage.getItem('lovesite_timeline');
            if (saved) {
                timelineItems = JSON.parse(saved);
            }
            renderTimelineItems();
        }

        // ============ å¿ƒè¯­è®¾ç½® ============
        function saveMessageSettings() {
            const settings = {
                content: document.getElementById('messageContent').value,
                signature: document.getElementById('messageSignature').value
            };
            localStorage.setItem('lovesite_message', JSON.stringify(settings));
            showToast('å¿ƒè¯­ä¿å­˜æˆåŠŸï¼');
        }

        function loadMessageSettings() {
            const saved = localStorage.getItem('lovesite_message');
            if (saved) {
                const settings = JSON.parse(saved);
                document.getElementById('messageContent').value = settings.content || '';
                document.getElementById('messageSignature').value = settings.signature || '';
            } else {
                document.getElementById('messageContent').value = 'æ„Ÿè°¢ä½ å‡ºç°åœ¨æˆ‘çš„ç”Ÿå‘½é‡Œ\nè®©å¹³å‡¡çš„æ—¥å­é—ªé—ªå‘å…‰\næ„¿æœªæ¥çš„æ¯ä¸€å¤©\néƒ½æœ‰ä½ çš„é™ªä¼´';
                document.getElementById('messageSignature').value = 'å†™ç»™æœ€ç‰¹åˆ«çš„ä½ ';
            }
        }

        // ============ åˆå§‹åŒ– ============
        document.addEventListener('DOMContentLoaded', () => {
            loadBasicSettings();
            loadPhotoSettings();
            loadMusicSettings();
            loadTimelineSettings();
            loadMessageSettings();
        });
    </script>
</body>
</html>

